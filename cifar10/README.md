# cifar10 play

## cifar10-r1
this version based on official tutorial
the accuracy is about 60%

By using RandomHorizontalFlip transform for training set, the accuracy increases, around 67%

## cifar10-r2
modify the network 
By using the resnet18 torchvision provided, the accuracy increases, around 75% 
by adding more argument [RandomCrop] & resnet18, when at epoch 30, the accuracy is around 83.2%(epoch 54, train acc: 87.4%)

## cifiar10-r3
using the updated mean_and_std and resume the training again.
it continue training, and the accuracy increase a little bit.
``` bash
training epoch70, accuracy: 89.56
evaluating, epoch: 69
test epoch 70, test loss: 0.520
Accuracy of the network on the test images: 83.9 %
Accuracy of plane: 86.2 %
Accuracy of car: 91.3 %
Accuracy of bird: 76.3 %
Accuracy of cat: 59.7 %
Accuracy of deer: 85.4 %
Accuracy of dog: 80.2 %
Accuracy of frog: 89.3 %
Accuracy of horse: 87.1 %
Accuracy of ship: 91.6 %
Accuracy of trunk: 91.5 %
```

## cifar10-r4
re-training from scratch, and using scheduler to accelerate the training procedure.
the accuracy is not improved.

## mean_and_std
have you confuse about how to set the mean & std value? for ImageNet, why using that value?
This code snippet explain it:
```python
import sys
import math
import torch

def get_mean_and_std(dataset):
	''' Compute the mean and std value of dataset. '''
	dataloader = torch.utils.data.DataLoader(dataset, batch_size=1, shuffle=True, num_workers=4)
	mean = torch.zeros(3)
	std = torch.zeros(3)
	for batch_idx, (inputs, targets) in enumerate(dataloader):
		for i in range(3): # for 3 channels, colored image
			mean[i] += inputs[:,i,:,:].mean()
			std[i] += inputs[:,i,:,:].std()
	mean.div_(len(dataset))
	std.div_(len(dataset))
	return mean, std
```
So, for CIFAR10 image dataset, we can get
```python
mean, std of trainset: tensor([0.4914, 0.4822, 0.4465]) tensor([0.2023, 0.1994, 0.2010])
```


By comparing kuangliu's pytorch-cifar, it seems the original resnet18 could not convergence like his implementation:

```
# use torchvision.model.resnet18()

Epoch: 494
 [=========================== 391/391 ============================>]  Step: 19ms | Tot: 9s174ms | Loss: 0.030 | Acc: 99.018% (49509/50000)                              
 [=========================== 100/100 ============================>]  Step: 9ms | Tot: 771ms | Loss: 0.574 | Acc: 87.220% (8722/10000)                                  

Epoch: 495
 [=========================== 391/391 ============================>]  Step: 19ms | Tot: 9s214ms | Loss: 0.030 | Acc: 99.042% (49521/50000)                              
 [=========================== 100/100 ============================>]  Step: 12ms | Tot: 813ms | Loss: 0.589 | Acc: 87.570% (8757/10000)                                 

Epoch: 496
 [=========================== 391/391 ============================>]  Step: 19ms | Tot: 9s207ms | Loss: 0.031 | Acc: 99.000% (49500/50000)                              
 [=========================== 100/100 ============================>]  Step: 13ms | Tot: 786ms | Loss: 0.589 | Acc: 87.310% (8731/10000)    
```
 Use the pre defined resnet18 model, and modify its first layer from kernel_size=7 & stride=3 to kernel_size=3, stride=1, can improve the accuracy, and reaches around 94%







## MobileNet V2 training

```bash
Train epoch:264: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.370]
test epoch:264: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.93it/s, loss:0.002, accuracy:93.400]
Train epoch:265: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.370]
test epoch:265: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.04it/s, loss:0.002, accuracy:93.580]
saving best for inference...
saving best checkpoint for training resume...
Train epoch:266: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.422]
test epoch:266: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.07it/s, loss:0.002, accuracy:93.330]
Train epoch:267: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.460]
test epoch:267: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.95it/s, loss:0.003, accuracy:93.300]
Train epoch:268: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.506]
test epoch:268: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.06it/s, loss:0.003, accuracy:93.270]
Train epoch:269: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.426]
test epoch:269: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.09it/s, loss:0.003, accuracy:93.330]
Train epoch:270: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.424]
test epoch:270: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.01it/s, loss:0.003, accuracy:93.350]
Train epoch:271: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.476]
test epoch:271: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.17it/s, loss:0.003, accuracy:93.250]
Train epoch:272: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.448]
test epoch:272: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.92it/s, loss:0.003, accuracy:93.180]
Train epoch:273: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.444]
test epoch:273: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.99it/s, loss:0.003, accuracy:93.350]
Train epoch:274: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.60it/s, loss:0.000, accuracy:99.582]
test epoch:274: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.86it/s, loss:0.003, accuracy:93.180]
Train epoch:275: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.540]
test epoch:275: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.99it/s, loss:0.003, accuracy:93.270]
Train epoch:276: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.562]
test epoch:276: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.00it/s, loss:0.003, accuracy:93.260]
Train epoch:277: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.548]
test epoch:277: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 39.09it/s, loss:0.003, accuracy:93.150]
Train epoch:278: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.60it/s, loss:0.000, accuracy:99.542]
test epoch:278: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.05it/s, loss:0.003, accuracy:93.220]
Train epoch:279: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.544]
test epoch:279: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.08it/s, loss:0.003, accuracy:93.230]
Train epoch:280: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.564]
test epoch:280: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.08it/s, loss:0.003, accuracy:93.220]
Train epoch:281: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.578]
test epoch:281: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.98it/s, loss:0.003, accuracy:93.170]
Train epoch:282: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.588]
test epoch:282: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.00it/s, loss:0.003, accuracy:93.220]
Train epoch:283: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.610]
test epoch:283: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.98it/s, loss:0.003, accuracy:93.180]
Train epoch:284: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.60it/s, loss:0.000, accuracy:99.652]
test epoch:284: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.98it/s, loss:0.003, accuracy:93.390]
Train epoch:285: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.622]
test epoch:285: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.09it/s, loss:0.003, accuracy:93.270]
Train epoch:286: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.616]
test epoch:286: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.98it/s, loss:0.003, accuracy:93.380]
Train epoch:287: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.60it/s, loss:0.000, accuracy:99.592]
test epoch:287: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.97it/s, loss:0.003, accuracy:93.250]
Train epoch:288: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.660]
test epoch:288: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.84it/s, loss:0.003, accuracy:93.290]
Train epoch:289: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.668]
test epoch:289: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.02it/s, loss:0.003, accuracy:93.220]
Train epoch:290: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.686]
test epoch:290: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.03it/s, loss:0.003, accuracy:93.410]
Train epoch:291: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.676]
test epoch:291: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.00it/s, loss:0.003, accuracy:93.310]
Train epoch:292: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.648]
test epoch:292: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.06it/s, loss:0.003, accuracy:93.210]
Train epoch:293: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.658]
test epoch:293: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.04it/s, loss:0.003, accuracy:93.230]
Train epoch:294: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.658]
test epoch:294: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 37.97it/s, loss:0.003, accuracy:93.270]
Train epoch:295: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.626]
test epoch:295: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.02it/s, loss:0.003, accuracy:93.110]
Train epoch:296: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.676]
test epoch:296: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.08it/s, loss:0.003, accuracy:93.040]
Train epoch:297: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.656]
test epoch:297: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.14it/s, loss:0.003, accuracy:93.230]
Train epoch:298: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.674]
test epoch:298: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.06it/s, loss:0.003, accuracy:93.320]
Train epoch:299: 100%|███████████████████████████████████████████████████████████████████████████████████| 196/196 [00:42<00:00,  4.59it/s, loss:0.000, accuracy:99.688]
test epoch:299: 100%|████████████████████████████████████████████████████████████████████████████████████| 100/100 [00:02<00:00, 38.05it/s, loss:0.003, accuracy:93.210]
```

